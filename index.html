<!--
Developed by: Salman
GitHub: https://github.com/salmantok
--><!DOCTYPE html><html lang="id"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>gas-convert</title><style>/*! Tomorrow Night Bright Theme
Original theme - https://github.com/chriskempson/tomorrow-theme
http://jmblog.github.com/color-themes-for-google-code-highlightjs
Tomorrow Comment */pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}.hljs-comment,.hljs-quote{color:#969896}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#d54e53}.hljs-built_in,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#e78c45}.hljs-attribute{color:#e7c547}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#b9ca4a}.hljs-section,.hljs-title{color:#7aa6da}.hljs-keyword,.hljs-selector-tag{color:#c397d8}.hljs{background:#000;color:#eaeaea}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><style>.dark-mode-toggle{border:none}.footer a{text-decoration:none}.link{text-decoration:none}.link{text-decoration:none}.link{text-decoration:none}</style><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/css/bootstrap.min.css" integrity="sha512-jnSuA4Ss2PkkikSOLtYs8BlYIeeIK1h99ty4YfvRPAlzr377vr3CXDb7sb7eEEBYjDtcYj+AjBH3FLv5uSJuXg==" crossorigin="anonymous" referrerpolicy="no-referrer"></head><body data-bs-theme="light" class="d-flex flex-column min-vh-100 p-2"><header class="d-flex align-items-center justify-content-between border-bottom mb-4"><h1 class="mb-1">gas-convert</h1><button class="dark-mode-toggle mb-1">Dark Mode</button></header><main class="flex-grow-1"><p><a href="https://github.com/salmantok/gas-convert.git" class="link">gas-convert </a>mengonversi dan mengoptimalkan kode JavaScript agar kompatibel dengan <a href="https://script.google.com" class="link">Google Apps Script</a>.</p><h2>Instalasi</h2><pre><code class="hljs language-bash">npm install -g gas-convert
</code></pre><p>Sebelum menggunakan pastikan <a href="https://github.com/google/clasp#readme" class="link">@google/clasp </a>sudah terinstall di sistem operasi Anda, jika belum terinstall maka install terlebih dahulu.</p><pre><code class="hljs language-bash">npm install -g @google/clasp
</code></pre><p>Setelah itu login</p><pre><code class="hljs language-bash">clasp login
</code></pre><p>Kemudian buat project di direktori saat ini</p><pre><code class="hljs language-bash">clasp create
</code></pre><p>Atau di direktori src</p><pre><code class="hljs language-bash"><span class="hljs-built_in">mkdir</span> src &amp;&amp; clasp create --rootDir src &amp;&amp; <span class="hljs-built_in">mv</span> src/.clasp.json .
</code></pre><p>Atau clone di direktori saat ini jika Anda sudah membuat project sebelumnya</p><pre><code class="hljs language-bash">clasp <span class="hljs-built_in">clone</span> &lt;scriptId&gt; --rootDir .
</code></pre><p>Atau clone di direktori src jika Anda sudah membuat project sebelumnya</p><pre><code class="hljs language-bash"><span class="hljs-built_in">mkdir</span> src &amp;&amp; clasp <span class="hljs-built_in">clone</span> &lt;scriptId&gt; --rootDir src &amp;&amp; <span class="hljs-built_in">mv</span> src/.clasp.json .
</code></pre><h3>Sintaks CLI <code>gas-convert</code></h3><p><code>gasc &lt;inputFile&gt; &lt;outputFile&gt;</code></p><pre><code class="hljs language-bash">gasc index.js Kode.js
</code></pre><p>Atau:</p><pre><code class="hljs language-bash">gasc index.js src/Kode.js
</code></pre><p>Unggah hasil konversi ke Google Apps Script</p><pre><code class="hljs language-bash">clasp push
</code></pre><h3>Contoh project</h3><p>Ada 3 cara untuk konversi</p><p>Buat file sumber terlebih dahulu, misalnya (utils.js, logger.js, dan index.js), lalu gabungkan menjadi satu file.</p><h4>Cara ke 1.</h4><pre><code class="hljs language-js"><span class="hljs-comment">// utils.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">sayHello</span>(<span class="hljs-params">name</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Halo, <span class="hljs-subst">${name}</span>!`</span>);
}
</code></pre><pre><code class="hljs language-js"><span class="hljs-comment">// logger.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">logMessage</span>(<span class="hljs-params">message</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`LOG: <span class="hljs-subst">${message}</span>`</span>);
}
</code></pre><pre><code class="hljs language-js"><span class="hljs-comment">// index.js</span>
<span class="hljs-keyword">import</span> { sayHello } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./utils.js&#x27;</span>;
<span class="hljs-keyword">import</span> { logMessage } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./logger.js&#x27;</span>;

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Program dimulai&#x27;</span>);
<span class="hljs-title function_">sayHello</span>(<span class="hljs-string">&#x27;GAS&#x27;</span>);
<span class="hljs-title function_">logMessage</span>(<span class="hljs-string">&#x27;Ini adalah pesan log&#x27;</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Program selesai&#x27;</span>);
</code></pre><h4>Cara ke 2.</h4><pre><code class="hljs language-js"><span class="hljs-comment">// utils.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">sayHello</span>(<span class="hljs-params">name</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Halo, <span class="hljs-subst">${name}</span>!`</span>);
}
</code></pre><pre><code class="hljs language-js"><span class="hljs-comment">// logger.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">logMessage</span>(<span class="hljs-params">message</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`LOG: <span class="hljs-subst">${message}</span>`</span>);
}
</code></pre><pre><code class="hljs language-js"><span class="hljs-comment">// index.js</span>
<span class="hljs-keyword">import</span> { sayHello } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./utils.js&#x27;</span>;
<span class="hljs-keyword">import</span> { logMessage } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./logger.js&#x27;</span>;

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Program dimulai&#x27;</span>);
<span class="hljs-title function_">sayHello</span>(<span class="hljs-string">&#x27;GAS&#x27;</span>);
<span class="hljs-title function_">logMessage</span>(<span class="hljs-string">&#x27;Ini adalah pesan log&#x27;</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Program selesai&#x27;</span>);

<span class="hljs-comment">// Tambahkan fungsi ke globalThis agar bisa diakses di mana saja</span>
globalThis.<span class="hljs-property">sayHello</span> = sayHello;
globalThis.<span class="hljs-property">logMessage</span> = logMessage;
</code></pre><h4>Cara ke 3.</h4><pre><code class="hljs language-js"><span class="hljs-comment">// utils.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">sayHello</span>(<span class="hljs-params">name</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Halo, <span class="hljs-subst">${name}</span>!`</span>);
}
</code></pre><pre><code class="hljs language-js"><span class="hljs-comment">// logger.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">logMessage</span>(<span class="hljs-params">message</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`LOG: <span class="hljs-subst">${message}</span>`</span>);
}
</code></pre><pre><code class="hljs language-js"><span class="hljs-comment">// index.js</span>
<span class="hljs-keyword">import</span> { sayHello } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./utils.js&#x27;</span>;
<span class="hljs-keyword">import</span> { logMessage } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./logger.js&#x27;</span>;

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Program dimulai&#x27;</span>);

<span class="hljs-keyword">function</span> <span class="hljs-title function_">doPost</span>(<span class="hljs-params">e</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;App Started&#x27;</span>);

  <span class="hljs-comment">// Daftarkan fungsi ke globalThis saat doPost dipanggil</span>
  globalThis.<span class="hljs-property">sayHello</span> = sayHello;
  globalThis.<span class="hljs-property">logMessage</span> = logMessage;

  <span class="hljs-comment">// Contoh pemanggilan fungsi setelah terdaftar di globalThis</span>
  <span class="hljs-title function_">sayHello</span>(<span class="hljs-string">&#x27;GAS&#x27;</span>);
  <span class="hljs-title function_">logMessage</span>(<span class="hljs-string">&#x27;Ini adalah pesan log&#x27;</span>);

  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Program selesai&#x27;</span>);
}
globalThis.<span class="hljs-property">doPost</span> = doPost;
</code></pre><h3>Penjelasan Hasil konversi Satu per Satu</h3><p>1️⃣ <strong>Hasil Konversi Pertama</strong></p><p>✅ <strong>Penjelasan:</strong></p><ul><li>Semua kode berjalan <strong>langsung saat script dieksekusi</strong>.</li><li>Fungsi <code>sayHello</code> dan <code>logMessage</code> langsung dipanggil setelah definisi.</li><li>Tidak ada <strong><code>globalThis</code></strong>, jadi fungsi <strong>tidak bisa diakses</strong> dari luar file.</li><li>Ini cocok untuk <strong>sistem yang tidak perlu fungsi global</strong>, tetapi kurang fleksibel untuk <strong>Google Apps Script</strong>.</li></ul><p><strong>2️⃣ Hasil Konversi Kedua</strong></p><p>✅ <strong>Penjelasan:</strong></p><ul><li>Kode tetap langsung dieksekusi seperti pada <strong>Cara ke 1</strong>.</li><li><strong>Perbedaan utama</strong> adalah fungsi <code>sayHello</code> dan <code>logMessage</code> <strong>ditambahkan ke <code>globalThis</code></strong>, sehingga bisa dipanggil dari luar.</li><li>Contoh:</li></ul><pre><code class="hljs language-js"><span class="hljs-title function_">sayHello</span>(<span class="hljs-string">&#x27;GAS&#x27;</span>); <span class="hljs-comment">// Bisa dipanggil di Google Apps Script</span>
<span class="hljs-title function_">logMessage</span>(<span class="hljs-string">&#x27;Pesan baru&#x27;</span>);
</code></pre><ul><li><strong>Kelebihan:</strong> Bisa digunakan di luar file.</li><li><strong>Kekurangan:</strong> Masih kurang fleksibel karena <strong>kode langsung berjalan saat file dimuat</strong>, bukan hanya saat diperlukan.</li></ul><p><strong>3️⃣ Hasil Konversi Ketiga</strong></p><p>✅ <strong>Penjelasan:</strong></p><ul><li>Tidak seperti cara sebelumnya, sekarang fungsi tidak langsung berjalan kecuali melalui <code>doPost()</code>.</li><li><strong>doPost() sebagai titik masuk utama</strong> untuk Google Apps Script.</li><li>Saat <code>doPost()</code> dipanggil:</li></ul><ol><li><code>Logger.log(&quot;App Started&quot;)</code> dieksekusi.</li><li><code>sayHello</code> dan <code>logMessage</code> ditambahkan ke <code>globalThis</code>.</li><li>Fungsi dipanggil untuk menunjukkan bahwa mereka bekerja.</li><li><code>Logger.log(&quot;Program selesai&quot;)</code> dicetak di akhir.</li></ol><ul><li><strong>Kelebihan:</strong></li><li><strong>Lebih fleksibel</strong> karena hanya berjalan saat <code>doPost()</code> dipanggil.</li><li>Fungsi tetap bisa digunakan di luar <code>doPost()</code>.</li><li>Kompatibel dengan <strong>Google Apps Script</strong>.</li></ul><div class="container"><h2 class="mb-4">Kesimpulan</h2><div class="table-responsive"><table class="table table-bordered table-striped"><thead class="table-dark"><tr><th>Versi</th><th>Kapan Kode Berjalan?</th><th>Bisa Pakai globalThis?</th><th>Cocok Untuk?</th></tr></thead><tbody><tr><td><strong>Cara ke 1</strong></td><td>Langsung saat script dijalankan</td><td class="text-danger">❌ Tidak</td><td>Skrip mandiri</td></tr><tr><td><strong>Cara ke 2</strong></td><td>Langsung saat script dijalankan</td><td class="text-success">✅ Ya</td><td>Bisa diakses di luar file, tapi tetap langsung berjalan</td></tr><tr><td><strong>Cara ke 3</strong></td><td>Hanya saat <code>doPost()</code> dipanggil</td><td class="text-success">✅ Ya</td><td>Google Apps Script, lebih fleksibel</td></tr></tbody></table></div><div class="alert alert-info mt-4"><strong>💡 Rekomendasi: </strong>Gunakan <strong>Cara ke 3 </strong>untuk <strong>Google Apps Script</strong>, karena lebih fleksibel dan tidak langsung berjalan sebelum <code>doPost()</code> dipanggil.</div></div></main><footer class="mt-2 py-2 text-center small text-secondary border-top footer a"><p>Copyright &copy; 2025 <a href="https://github.com/salmantok">Salman</a>. All rights reserved.</p></footer><script>document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll("pre").forEach((e=>{const t=e.querySelector("code"),n=t.className.split("language-")[1]||"plain",o=document.createElement("div");o.className="d-flex justify-content-between align-items-center p-2 rounded mb-0 bg-body-tertiary",o.style.fontSize="12px",o.style.padding="4px 8px",e.parentElement.insertBefore(o,e);const a=document.createElement("span");a.textContent=n.toUpperCase(),a.className="text-nowrap",o.appendChild(a);const i=document.createElement("button");i.innerText="Copy",i.className="btn btn-sm",i.style.fontSize="10px",i.style.padding="2px 6px",i.onclick=()=>{navigator.clipboard.writeText(t.innerText).then((()=>{i.innerText="Copied!",setTimeout((()=>i.innerText="Copy"),2e3)}))},o.appendChild(i);const l=document.createElement("div");l.className="position-relative mb-4",e.parentElement.insertBefore(l,o.nextSibling),l.appendChild(e)}))}))</script><script>document.addEventListener("DOMContentLoaded",(()=>{const t=document.querySelector(".dark-mode-toggle"),e=document.body,d=localStorage.getItem("theme")||"light";e.setAttribute("data-bs-theme",d),t.textContent="dark"===d?"Light Mode":"Dark Mode",t.addEventListener("click",(()=>{const d="dark"===e.getAttribute("data-bs-theme")?"light":"dark";e.setAttribute("data-bs-theme",d),t.textContent="dark"===d?"Light Mode":"Dark Mode",localStorage.setItem("theme",d)}))}))</script><script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/js/bootstrap.bundle.min.js" integrity="sha512-7Pi/otdlbbCR+LnW+F7PwFcSDJOuUJB3OxtEHbg4vSMvzvJjde4Po1v4BR9Gdc9aXNUNFVUY+SK51wWT8WF0Gg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script></body></html>